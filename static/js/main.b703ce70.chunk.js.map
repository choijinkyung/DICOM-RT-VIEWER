{"version":3,"sources":["logo.svg","main/dicomParse.js","main/pixel2voxel.js","main/openFile.js","main/checkbox.js","main/voxel2pixel.js","main/ROI.js","main/rgbToHex.js","main/loadData.js","main/MainUI.js","main/buttonEventFunction.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","dicomParse","image","document","getElementById","textContent","data","string","ex","alert","voxelCal","imgPosArr","split","Sx","parseFloat","Sy","Sz","imgOri","imgOriArr","toString","Xx","Xy","Xz","Yx","Yy","Yz","pixelSpace","pixelSpaceArr","Di","Dj","el","addEventListener","event","pixelCoords","cornerstone","pageX","pageY","x","y","Px","Py","Pz","Math","floor","readTextFile","addCheckbox","ROI_LIST_Array","forEach","n","ul","li","createElement","checkbox","type","value","x30060022","name","class","append","text","x30060026","createTextNode","pixelCal","dataSet","struct","str","vPx","vPy","vPz","i","length","voxel","pi","pj","rgbToHex","color","hex","Number","fullColorHex","rgb","r","g","b","isASCII","test","structFile","file","innerHTML","$","removeClass","addClass","empty","reader","FileReader","onload","arrayBuffer","result","byteArray","Uint8Array","kb","mb","byteStr","toFixed","setTimeout","start","Date","getTime","dicomParser","parseDicom","output1","output3","ROIList","contour","roi_List","ROI_Number","ROI_Name","filter","item","undefined","Array","ROI_object","Object","push","roiJson","contourList","Referenced_Instance_UID","contour_data","Referenced_ROI_Number","ROI_display_color","j","contour_object","x30060084","x00081155","x30060050","x3006002a","contour_data_Array","contourJson","ready","click","prop","join","time","warnings","html","warning","elements","x7fe00010","err","message","exception","readAsArrayBuffer","propertyName","element","tag","hadUndefinedLength","vr","items","fragments","itemNumber","fragment","basicOffset","basicOffsetTable","offset","uint16","uint32","canvas","ctx","sendImage","Instance_UID","draw","px","getContext","beginPath","moveTo","lineTo","closePath","stroke","fillStyle","globalAlpha","fill","reset","clearRect","width","height","cornerstoneWadoImageLoader","cornerstoneTools","Hammer","cornerstoneMath","img","currentImageIndex","updateTheImage","imageIds","imageIndex","then","viewport","loadData","imageId","handleFileSelect","evt","stopPropagation","preventDefault","files","dataTransfer","fileManager","add","handleDragOver","dropEffect","MainUIElements","this","dropZone","e","lastX","lastY","mouseButton","which","mouseMoveHandler","deltaX","deltaY","voi","windowWidth","scale","windowCenter","round","translation","mouseUpHandler","removeEventListener","id","className","onChange","target","handleFileChange","webkitdirectory","directory","multiple","dumpFiles","cnt","onwheel","index","imageIdList","onClick","AngleTool","mouseButtonMask","angleOn","LengthTool","lengthOn","EllipticalRoiTool","drawCircle","RectangleRoiTool","drawRectangle","EraserTool","eraserOn","style","reductionOn","expansionOn","invert","invertOn","pixelReplication","interpolationOn","hflip","hflipOn","vflip","vflipOn","rotation","rotateOn","onContextMenu","onWheel","ref","input","React","Component","App","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","registration","unregister","catch","error","console"],"mappings":"wKAAAA,EAAOC,QAAU,IAA0B,kC,+NC2B5BC,MAzBf,SAAoBC,GAChB,IAEIC,SAASC,eAAe,WAAWC,YAAc,gBAAkBH,EAAMI,KAAKC,OAAO,aACrFJ,SAASC,eAAe,WAAWC,YAAc,kBAAoBH,EAAMI,KAAKC,OAAO,aAAtC,mBAA+EL,EAAMI,KAAKC,OAAO,aAClJJ,SAASC,eAAe,YAAYC,YAAc,cAAgBH,EAAMI,KAAKC,OAAO,aACpFJ,SAASC,eAAe,YAAYC,YAAc,cAAgBH,EAAMI,KAAKC,OAAO,aACpFJ,SAASC,eAAe,eAAeC,YAAc,kBAAoBH,EAAMI,KAAKC,OAAO,aAa7F,MAAOC,GACLC,MAAM,mBCqDCC,MAxEf,SAAkBR,GAEd,GAAkB,OADHA,EAAMI,KAAKC,OAAO,aACR,CACrB,IACII,EADST,EAAMI,KAAKC,OAAO,aACRK,MAAM,MAEzBC,EAAiC,GAA3BC,WAAWH,EAAU,IAAY,GACvCI,EAAiC,GAA3BD,WAAWH,EAAU,IAAY,GACvCK,EAAiC,GAA3BF,WAAWH,EAAU,IAAY,GAEvCM,EAASf,EAAMI,KAAKC,OAAO,aAE3BW,GADJD,EAASA,EAAOE,YACOP,MAAM,MAEzBQ,EAAiC,GAA3BN,WAAWI,EAAU,IAAY,GACvCG,EAAiC,GAA3BP,WAAWI,EAAU,IAAY,GACvCI,EAAiC,GAA3BR,WAAWI,EAAU,IAAY,GACvCK,EAAiC,GAA3BT,WAAWI,EAAU,IAAY,GACvCM,EAAiC,GAA3BV,WAAWI,EAAU,IAAY,GACvCO,EAAiC,GAA3BX,WAAWI,EAAU,IAAY,GAEvCQ,EAAaxB,EAAMI,KAAKC,OAAO,aAE/BoB,GADJD,EAAaA,EAAWP,YACOP,MAAM,MAEjCgB,EAAKd,WAAgC,GAApBa,EAAc,IAAY,GAC3CE,EAAKf,WAAgC,GAApBa,EAAc,IAAY,GAE3CG,EAAK3B,SAASC,eAAe,cAqCjC,OA5BA0B,EAAGC,iBAAiB,aAAa,SAAUC,GACvC,IAAMC,EAAcC,cAAwBJ,EAAIE,EAAMG,MAAOH,EAAMI,OACnEjC,SAASC,eAAe,UAAUC,YAAc,SAAW2B,EAAMG,MAAQ,WAAaH,EAAMI,MAAQ,YAAcH,EAAYI,EAAI,YAAcJ,EAAYK,EAE5J,IAAIC,EAAMnB,EAAKQ,EAAKK,EAAYI,EAAMd,EAAKM,EAAKI,EAAYK,EAAKzB,EAC7D2B,EAAMnB,EAAKO,EAAKK,EAAYI,EAAMb,EAAKK,EAAKI,EAAYK,EAAKvB,EAC7D0B,EAAMnB,EAAKM,EAAKK,EAAYI,EAAMZ,EAAKI,EAAKI,EAAYK,EAAKtB,EAEjEuB,EAAKG,KAAKC,MAAW,GAALJ,GAAW,GAC3BC,EAAKE,KAAKC,MAAW,GAALH,GAAW,GAC3BC,EAAKC,KAAKC,MAAW,GAALF,GAAW,GAC3BtC,SAASC,eAAe,eAAeC,YAAc,QAAUkC,EAAK,UAAYC,EAAK,UAAYC,KAGrGX,EAAGC,iBAAiB,YAAY,SAAUC,GACtC,IAAMC,EAAcC,cAAwBJ,EAAIE,EAAMG,MAAOH,EAAMI,OACnEjC,SAASC,eAAe,cAAcC,YAAc,SAAW2B,EAAMG,MAAQ,WAAaH,EAAMI,MAAQ,YAAcH,EAAYI,EAAI,YAAcJ,EAAYK,EAEhK,IAAIC,EAAMnB,EAAKQ,EAAKK,EAAYI,EAAMd,EAAKM,EAAKI,EAAYK,EAAKzB,EAC7D2B,EAAMnB,EAAKO,EAAKK,EAAYI,EAAMb,EAAKK,EAAKI,EAAYK,EAAKvB,EAC7D0B,EAAMnB,EAAKM,EAAKK,EAAYI,EAAMZ,EAAKI,EAAKI,EAAYK,EAAKtB,EAEjEuB,EAAKG,KAAKC,MAAW,GAALJ,GAAW,GAC3BC,EAAKE,KAAKC,MAAW,GAALH,GAAW,GAC3BC,EAAKC,KAAKC,MAAW,GAALF,GAAW,GAE3BtC,SAASC,eAAe,cAAcC,YAAc,QAAUkC,EAAK,UAAYC,EAAK,UAAYC,KAE7F,CAAC5B,EAAIE,EAAIa,EAAIC,GAEpBpB,MAAM,kBCjDCmC,I,gBCHAC,MAnBf,SAAqBC,GACjBA,EAAeC,SAAQ,SAAUC,GAC7B,IAAIC,EAAK9C,SAASC,eAAe,MAC7B8C,EAAK/C,SAASgD,cAAc,MAE5BC,EAAWjD,SAASgD,cAAc,SACtCC,EAASC,KAAO,WAChBD,EAASE,MAAQN,EAAEO,UACnBH,EAASI,KAAO,MAChBJ,EAASK,MAAQ,SAEjBP,EAAGQ,OAAON,GAEV,IAAIO,EAAOX,EAAEY,UACbV,EAAGQ,OAAOvD,SAAS0D,eAAeF,IAClCV,EAAGS,OAAOR,OCwCHY,IC7CXC,ED6CWD,EAhDf,SAAkB5D,EAAO8D,GAQrB,IAPA,IAAIC,EAAMD,EAAOpD,MAAM,MAEnBsD,EAAM,GACNC,EAAM,GACNC,EAAM,GAGDC,EAAI,EAAGA,EAAIJ,EAAIK,OAAQD,IACxBA,EAAI,IAAM,EACVH,EAAIG,GAAKJ,EAAII,GACNA,EAAI,IAAM,EACjBF,EAAIE,GAAKJ,EAAII,GACNA,EAAI,IAAM,IACjBD,EAAIC,GAAKJ,EAAII,IAiBrB,IAXA,IAAIE,EAAQ7D,EAASR,GACjBW,EAAK0D,EAAM,GACXxD,EAAKwD,EAAM,GACX3C,EAAK2C,EAAM,GACX1C,EAAK0C,EAAM,GAEXC,EAAK,GACLC,EAAK,GAIAJ,EAAI,EAAGA,EAAIJ,EAAIK,OAAQD,IACxBA,EAAI,IAAM,EACVG,EAAGH,GAAK3B,KAAKC,OAAQuB,EAAIG,GAAKxD,GAAOe,EAAO,IAAM,GAC3CyC,EAAI,IAAM,IACjBI,EAAGJ,GAAK3B,KAAKC,OAAQwB,EAAIE,GAAKtD,GAAOc,EAAO,IAAM,IAW1D,MAAO,CAAC2C,EAAIC,IErDZC,EAAW,SAAUC,GACrB,IAAIC,EAAMC,OAAOF,GAAOxD,SAAS,IAIjC,OAHIyD,EAAIN,OAAS,IACbM,EAAM,IAAMA,GAETA,GAiBIE,EAdI,SAAUC,GAGzB,IAAIC,GAFJD,EAAMA,EAAInE,MAAM,OAEJ,GACRqE,EAAIF,EAAI,GACRG,EAAIH,EAAI,GAMZ,MAAO,IAJGL,EAASM,GACPN,EAASO,GACVP,EAASQ,IDXxB,SAASC,EAAQlB,GACb,MAAO,iBAAiBmB,KAAKnB,GAKjC,SAASoB,EAAWC,GAEhBnF,SAASC,eAAe,YAAYmF,UAAY,GAChDpF,SAASC,eAAe,aAAamF,UAAY,GAEjDC,IAAE,WAAWC,YAAY,4CAA4CC,SAAS,cAC9EF,IAAE,aAAaG,QACfxF,SAASC,eAAe,eAAemF,UAAY,sCAEnD,IAAIK,EAAS,IAAIC,WA+EjB,OA9EAD,EAAOE,OAAS,SAAUR,GACtB,IAAIS,EAAcH,EAAOI,OAGrBC,EAAY,IAAIC,WAAWH,GAE3BI,EAAKF,EAAU3B,OAAS,KACxB8B,EAAKD,EAAK,KACVE,EAAUD,EAAK,EAAIA,EAAGE,QAAQ,GAAK,MAAQH,EAAGG,QAAQ,GAAK,MAE/DnG,SAASC,eAAe,eAAemF,UAAY,mBAAqBc,EAAU,wBAIlFE,YAAW,WAEP,IACI,IAAIC,GAAQ,IAAIC,MAAOC,UACvB3C,EAAU4C,IAAYC,WAAWX,GAEjC,IAAIY,EAAU,GACVC,EAAU,GAEdC,EAAQhD,GACRiD,EAAQjD,EAAS8C,EAASC,GA4N1C,SAAiBG,GAIb,IAHA,IAAIC,EAAa,GACbC,EAAW,GAEN9C,EAAI,EAAGA,EAAI4C,EAAS3C,OAAQD,IACd,aAAf4C,EAAS5C,GACT6C,EAAW7C,GAAK4C,EAAS5C,EAAI,GACP,aAAf4C,EAAS5C,KAChB8C,EAAS9C,GAAK4C,EAAS5C,EAAI,IAKnC6C,EAAaA,EAAWE,QAAO,SAAUC,GACrC,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAElDF,EAAWA,EAASC,QAAO,SAAUC,GACjC,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAIlD7B,KAAE,WAGE,IAFA,IAAI1C,EAAiB,IAAIyE,MAEhBlD,EAAI,EAAGA,EAAI8C,EAAS7C,OAAQD,IAAK,CACtC,IAAImD,EAAa,IAAIC,OACrBD,EAAWjE,UAAY2D,EAAW7C,GAClCmD,EAAW5D,UAAYuD,EAAS9C,GAEhCvB,EAAe4E,KAAKF,GAExB3E,EAAYC,MA1PJ6E,CAAQV,GAgQxB,SAAqBW,GAMjB,IALA,IAAIC,EAA0B,GAC1BC,EAAe,GACfC,EAAwB,GACxBC,EAAoB,GAEf3D,EAAI,EAAGA,EAAIuD,EAAYtD,OAAQD,IAAK,CACzC,IAAI4D,EAAI,EAGR,GAA0B,aAAtBL,EAAYvD,EAAI,GAAmB,CAGnC,GAFAwD,EAAwBxD,GAAKuD,EAAYvD,EAAI,GAC7CyD,EAAazD,GAAKuD,EAAYvD,EAAI,GACR,aAAtBuD,EAAYvD,EAAI,GAChB0D,EAAsB1D,GAAKuD,EAAYvD,EAAI,QACxC,GAA0B,aAAtBuD,EAAYvD,EAAI,GACvB,IAAK4D,EAAI5D,EAAI,EAAG4D,EAAIL,EAAYtD,OAAQ2D,IACpC,GAA0B,aAAtBL,EAAYK,EAAI,GAAmB,CACnCF,EAAsB1D,GAAKuD,EAAYK,EAAI,GAC3C,MAIZ,GAAsB,aAAlBL,EAAYvD,GACZ2D,EAAkB3D,GAAKuD,EAAYvD,EAAI,QACpC,GAAsB,aAAlBuD,EAAYvD,GACnB,IAAK4D,EAAI5D,EAAG4D,EAAI,EAAGA,IACf,GAAsB,aAAlBL,EAAYK,GAAmB,CAC/BD,EAAkB3D,GAAKuD,EAAYK,EAAI,GACvC,QAOpBD,EAAoBA,EAAkBZ,QAAO,SAAUC,GACnD,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAElDQ,EAA0BA,EAAwBT,QAAO,SAAUC,GAC/D,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAElDS,EAAeA,EAAaV,QAAO,SAAUC,GACzC,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAElDU,EAAwBA,EAAsBX,QAAO,SAAUC,GAC3D,OAAgB,OAATA,QAA0BC,IAATD,GAA+B,KAATA,KAIlD7B,KAAE,WACE,IAAK,IAAInB,EAAI,EAAGA,EAAIuD,EAAYtD,OAAQD,IAAK,CACzC,IAAI6D,EAAiB,IAAIT,OACzBS,EAAeC,UAAYJ,EAAsB1D,GACjD6D,EAAeE,UAAYP,EAAwBxD,GACnD6D,EAAeG,UAAYP,EAAazD,GACxC6D,EAAeI,UAAYN,EAAkB3D,GAE7CkE,EAAmBb,KAAKQ,OAzTpBM,CAAYZ,GAwXxBpC,IAAErF,UAAUsI,OAAM,WACdjD,IAAE,yBAAyBkD,OAAM,WACxBlD,IAAE,QAAQmD,KAAK,YAIhBnD,IAAE,QAAQmD,KAAK,WAAW,GAC1BlI,MAAM,yDAJNA,MAAM,sDACN+E,IAAE,QAAQmD,KAAK,WAAW,UAxX1BxI,SAASC,eAAe,YAAYmF,UAAY,OAASsB,EAAQ+B,KAAK,IAAM,QAC5EzI,SAASC,eAAe,aAAamF,UAAY,OAASuB,EAAQ8B,KAAK,IAAM,QAE7E,IACIC,GADM,IAAIpC,MAAOC,UACJF,EACjB,GAAIzC,EAAQ+E,SAASxE,OAAS,EAC1BkB,IAAE,YAAYC,YAAY,yCAAyCC,SAAS,iBAC5EF,IAAE,gBAAgBuD,KAAK,iEAAmE1C,EAAU,cAAgBwC,EAAO,OAE3H9E,EAAQ+E,SAAS/F,SAAQ,SAAUiG,GAC/BxD,IAAE,aAAa9B,OAAO,OAASsF,EAAU,iBAG7BjF,EAAQkF,SAASC,WAE7B1D,IAAE,YAAYC,YAAY,yCAAyCC,SAAS,iBAC5EF,IAAE,eAAeuD,KAAK,+BAAiC1C,EAAU,cAAgBwC,EAAO,SAExFrD,IAAE,YAAYC,YAAY,yCAAyCC,SAAS,iBAC5EF,IAAE,gBAAgBuD,KAAK,qDAAuD1C,EAAU,cAAgBwC,EAAO,QAIzH,MAAOM,GACL,IAAIC,EAAUD,EAOd,GANIA,EAAIE,YACJD,EAAUD,EAAIE,WAElB7D,IAAE,WAAWC,YAAY,0CAA0CC,SAAS,gBAC5EvF,SAASC,eAAe,eAAemF,UAAY,mBAAqB6D,EAAU,kBAAoB/C,EAAU,KAE5G8C,EAAItC,SAAWsC,EAAIrC,QACnB3G,SAASC,eAAe,YAAYmF,UAAY,OAASsB,EAAQ+B,KAAK,IAAM,QAC5EzI,SAASC,eAAe,aAAamF,UAAY,OAASuB,EAAQ8B,KAAK,IAAM,aAC1E,GAAIO,EAAIpF,QAAS,CACpB,IAAI8C,EAAU,GACVC,EAAU,GAEdC,EAAQoC,EAAIpF,SACZiD,EAAQmC,EAAIpF,QAAS8C,EAASC,GAC9B3G,SAASC,eAAe,YAAYmF,UAAY,OAASsB,EAAQ+B,KAAK,IAAM,QAC5EzI,SAASC,eAAe,aAAamF,UAAY,OAASuB,EAAQ8B,KAAK,IAAM,YAGtF,KAEPhD,EAAO0D,kBAAkBhE,GAElBvB,EAGX,IAAIkD,EAAW,GAEf,SAASF,EAAQhD,GACb,IAAK,IAAD,WACSwF,GAEL,IAAIC,EAAUzF,EAAQkF,SAASM,GAG/B,GAAoB,cAAhBC,EAAQC,KAAwC,cAAhBD,EAAQC,KAAwC,cAAhBD,EAAQC,IAAqB,CAClFD,EAAQC,IACfD,EAAQE,oBACA,yBAEJ,KACJF,EAAQG,IACA,OAASH,EAAQG,GAAK,KAIlC,GAAIH,EAAQI,MACRJ,EAAQI,MAAM7G,SAAQ,SAAUsE,GAE5BN,EAAQM,EAAKtD,iBAEd,GAAIyF,EAAQK,UAAW,CAE1B,IAAIC,EAAa,EACjBN,EAAQK,UAAU9G,SAAQ,SAAUgH,GAChC,IAAIC,EACAR,EAAQS,mBACRD,EAAcR,EAAQS,iBAAiBH,IAEdA,IAA8BC,EAASG,OAE7CH,EAASzF,cAEjC,CACoB,IAAnBkF,EAAQlF,OACA,KAAOP,EAAQoG,OAAOZ,GAAgB,IAEpB,IAAnBC,EAAQlF,QACP,KAAOP,EAAQqG,OAAOb,GAAgB,IAGlD,IAAItF,EAAMF,EAAQxD,OAAOgJ,GACLpE,EAAQlB,QAIZqD,IAARrD,GACQ,IAAMA,EAAM,IAGD,IAAnBuF,EAAQlF,QAAmC,IAAnBkF,EAAQlF,SACxB,UAEA,sBAGO,IAAnBkF,EAAQlF,QACA,UAEZ2C,EAASS,KAAK8B,EAAQC,IAAK1F,EAAQxD,OAAOgJ,OA3DtD,IAAK,IAAIA,KAAgBxF,EAAQkF,SAAW,EAAnCM,GA+DX,MAAOJ,GAIL,KAHS,CACLE,UAAWF,IAMvB,IAAIvB,EAAc,GAElB,SAASZ,EAAQjD,EAAS8C,EAASC,GAC/B,IAAK,IAAD,WACSyC,GACL,IAAIC,EAAUzF,EAAQkF,SAASM,GAG/B,GAAoB,cAAhBC,EAAQC,KAAuC,cAAhBD,EAAQC,KAAuC,cAAhBD,EAAQC,KAAuC,cAAhBD,EAAQC,KAAuC,cAAhBD,EAAQC,KAAuC,cAAhBD,EAAQC,KAAuC,cAAhBD,EAAQC,IAAqB,CAC5MD,EAAQC,IAEfD,EAAQE,oBACA,yBAEJ,KACJF,EAAQG,IACA,OAASH,EAAQG,GAAK,KAOlC,GAAIH,EAAQI,MAAO,CAEfJ,EAAQI,MAAM7G,SAAQ,SAAUsE,GAI5BL,EAAQK,EAAKtD,QAAS8C,EAASC,WAIhC,GAAI0C,EAAQK,UAAW,CAE1B,IAAIC,EAAa,EACjBN,EAAQK,UAAU9G,SAAQ,SAAUgH,GAChC,IAAIC,EACAR,EAAQS,mBACRD,EAAcR,EAAQS,iBAAiBH,IAEdA,IAA8BC,EAASG,OAE7CH,EAASzF,cAEjC,CACoB,IAAnBkF,EAAQlF,OACA,KAAOP,EAAQoG,OAAOZ,GAAgB,IAEpB,IAAnBC,EAAQlF,QACP,KAAOP,EAAQqG,OAAOb,GAAgB,IAGlD,IAAItF,EAAMF,EAAQxD,OAAOgJ,GACLpE,EAAQlB,QAIZqD,IAARrD,GACQ,IAAMA,EAAM,IAGD,IAAnBuF,EAAQlF,QAAmC,IAAnBkF,EAAQlF,SACxB,UAEA,sBAGO,IAAnBkF,EAAQlF,QACA,UAKZsD,EAAYF,KAAK8B,EAAQC,IAAK1F,EAAQxD,OAAOgJ,OAtEzD,IAAK,IAAIA,KAAgBxF,EAAQkF,SAAW,EAAnCM,GA0EX,MAAOJ,GAKL,KAJS,CACLE,UAAWF,EACXrC,QAASA,GAIjB,OAAOc,EAsCX,IAiEI5D,EAAQW,EAjER4D,EAAqB,IAAIhB,MAkE7B,IAqBI8C,EACAC,EApBJ,SAASC,EAAUrK,GACf,IAAIsK,EACJA,EAAetK,EAAMI,KAAKC,OAAO,aAEjC,IAAK,IAAI8D,EAAI,EAAGA,EAAIkE,EAAmBjE,OAAQD,IANpC,IAOHkE,EAAmBlE,GAAnB,WACIkE,EAAmBlE,GAAnB,WAAsCmG,IACtCxG,EAASuE,EAAmBlE,GAAnB,UACTM,EAAQ4D,EAAmBlE,GAAnB,UAERoG,EAAKvK,EAAO8D,EAAQW,IAYpC,SAAS8F,EAAKvK,EAAO8D,EAAQW,GACzB,IAAI+F,EAAK5G,EAAS5D,EAAO8D,GACrBQ,EAAKkG,EAAG,GACRjG,EAAKiG,EAAG,GAEZL,EAASlK,SAASC,eAAe,aACjCkK,EAAMD,EAAOM,WAAW,OAEpBC,YACJN,EAAIO,OAAOrG,EAAG,GAAIC,EAAG,IACrB,IAAK,IAAIJ,EAAI,EAAGA,GAAiB,EAAZG,EAAGF,OAAYD,IAC5BA,EAAI,IAAM,GACViG,EAAIQ,OAAOtG,EAAGH,GAAII,EAAGJ,EAAI,IASjC,OANAiG,EAAIS,YACJT,EAAIU,SACJV,EAAIW,UAAYnG,EAAaH,GAC7B2F,EAAIY,YAAc,GAClBZ,EAAIa,OAEGd,EAGX,SAASe,IACLf,EAASlK,SAASC,eAAe,aACjCkK,EAAMD,EAAOM,WAAW,OAEpBU,UAAU,EAAG,EAAGhB,EAAOiB,MAAOjB,EAAOkB,QExZ7CC,WAAoCtJ,YAAcA,EAClDsJ,WAAoC7E,YAAcA,IAClD8E,WAA0BvJ,YAAcA,EACxCuJ,WAA0BC,OAASA,IACnCD,WAA0BE,gBAAkBA,EAC5CF,SAEA,IAuEIG,EAvEAC,EAAoB,GA0ExB,SAASC,EAAeC,EAAUC,GAC9B,IAAIlK,EAAK3B,SAASC,eAAe,cAmBjC,OAlBA8B,SAAmBJ,GACnB+J,EAAoBG,EACpB9J,YAAsB6J,EAASF,IAAoBI,MAAK,SAAU/L,GAC9D,IAAMgM,EAAWhK,6BAAuCJ,EAAI5B,GAErB,OAAnCA,EAAMI,KAAKC,OAAO,cAA4D,OAAnCL,EAAMI,KAAKC,OAAO,cAA4D,QAAnCL,EAAMI,KAAKC,OAAO,cACxG2B,eAAyBJ,EAAI5B,EAAOgM,GAEpCjM,EAAWC,GACXQ,EAASR,GACTqK,EAAUrK,GACV0L,EAAM1L,GAENO,MAAM,2DAKPmL,EAgBX,SAASO,EAASC,GACd,IAAItK,EAAK3B,SAASC,eAAe,cAejC,OAdA8B,SAAmBJ,GACnBI,YAAsBkK,GAASH,MAAK,SAAU/L,GAC1C,IAAMgM,EAAWhK,6BAAuCJ,EAAI5B,GACrB,OAAnCA,EAAMI,KAAKC,OAAO,cAA4D,OAAnCL,EAAMI,KAAKC,OAAO,cAA4D,QAAnCL,EAAMI,KAAKC,OAAO,cACxG2B,eAAyBJ,EAAI5B,EAAOgM,GAEpCjM,EAAWC,GACXQ,EAASR,GACTqK,EAAUrK,GACV0L,EAAM1L,GAENO,MAAM,2DAGPmL,EAUX,SAASS,EAAiBC,GACtBA,EAAIC,kBACJD,EAAIE,iBAGJ,IAAIC,EAAQH,EAAII,aAAaD,MAG7BpH,EAAWoH,EAAM,IAGjBN,EADgBX,UAAmCmB,YAAYC,IAAIH,EAAM,KAK7E,SAASI,EAAeP,GACpBA,EAAIC,kBACJD,EAAIE,iBACJF,EAAII,aAAaI,WAAa,OCpJlCtB,WAAoCtJ,YAAcA,EAClDsJ,WAAoC7E,YAAcA,IAClD8E,WAA0BvJ,YAAcA,EACxCuJ,WAA0BC,OAASA,IACnCD,WAA0BE,gBAAkBA,EAC5CF,S,IA2ResB,E,kLAtRP,IAAMvD,EAAUwD,KAAKxD,QAGjByD,EAAW9M,SAASC,eAAe,cACvC6M,EAASlL,iBAAiB,WAAY8K,GAAgB,GACtDI,EAASlL,iBAAiB,OAAQsK,GAAkB,GAEpD7C,EAAQzH,iBAAiB,aAAa,SAAUmL,GAC5C,IAAIC,EAAQD,EAAE/K,MACViL,EAAQF,EAAE9K,MACRiL,EAAcH,EAAEI,MAEtB,SAASC,EAAiBL,GACtB,IAAMM,EAASN,EAAE/K,MAAQgL,EACnBM,EAASP,EAAE9K,MAAQgL,EAIzB,GAHAD,EAAQD,EAAE/K,MACViL,EAAQF,EAAE9K,MAEU,IAAhBiL,EAAmB,CACnB,IAAInB,EAAWhK,cAAwBsH,GACvC0C,EAASwB,IAAIC,aAAgBH,EAAStB,EAAS0B,MAC/C1B,EAASwB,IAAIG,cAAiBJ,EAASvB,EAAS0B,MAChD1L,cAAwBsH,EAAS0C,GAEjC/L,SAASC,eAAe,cAAcC,YAAc,SAAWqC,KAAKoL,MAAM5B,EAASwB,IAAIC,aACjF,IAAMjL,KAAKoL,MAAM5B,EAASwB,IAAIG,mBAEjC,GAAoB,IAAhBR,EAAmB,CAC1B,IAAInB,EAAWhK,cAAwBsH,GACvC0C,EAAS6B,YAAY1L,GAAMmL,EAAStB,EAAS0B,MAC7C1B,EAAS6B,YAAYzL,GAAMmL,EAASvB,EAAS0B,MAC7C1L,cAAwBsH,EAAS0C,QAE9B,GAAoB,IAAhBmB,EAAmB,CAC1B,IAAInB,EAAWhK,cAAwBsH,GACvC0C,EAAS0B,OAAUH,EAAS,IAC5BvL,cAAwBsH,EAAS0C,GACjC/L,SAASC,eAAe,eAAeC,YAAc,QAAU6L,EAAS0B,MAAQ,KASxFzN,SAAS4B,iBAAiB,YAAawL,GACvCpN,SAAS4B,iBAAiB,WAN1B,SAASiM,IACL7N,SAAS8N,oBAAoB,YAAaV,GAC1CpN,SAAS8N,oBAAoB,UAAWD,W,+BAU1C,IAAD,OACL,OACI,yBAAKE,GAAG,iBAAiBC,UAAW,kBAChC,8CACI,2BAAO9K,KAAK,OAAO+K,SAAU,SAAClB,IDyBlD,SAA0BA,GACtBA,EAAEX,kBACFW,EAAEV,iBAEF,IAAIC,EAAQS,EAAEmB,OAAO5B,MAErBpH,EAAWoH,EAAM,IAEjBN,EADgBX,UAAmCmB,YAAYC,IAAIH,EAAM,KC/BrD6B,CAAiBpB,MAFzB,YAKA,mDACI,2BAAO7J,KAAK,OAAO6K,GAAG,aAAa1K,KAAK,WAAW+K,gBAAiB,GAAIC,UAAW,GAAIC,UAAQ,EACxFL,SAAU,SAAClB,ID5EtC,SAAqBA,GAiBjB,IAhBA,IAAId,EAAU,GACVsC,EAAY,GAaZC,EAAM,EAEDtK,EAAI,EAAGA,EAdN,IAceA,IACrB+H,EAAQ/H,GAAKmH,UAAmCmB,YAAYC,IAAIM,EAAEmB,OAAO5B,MAAMpI,IAC/EqK,EAAUrK,GAAK6I,EAAEmB,OAAO5B,MAAMpI,GAC1BsK,EAjBE,KAkBFlO,MAAM,qCAEVkO,IAMJtJ,EAAWqJ,EAAU,MACrB5C,EAAeM,EAASP,GAEf1L,SAASC,eAAe,cAC9BwO,QAEH,SAAgB1B,GAGZA,EAAEX,kBACFW,EAAEV,iBACF,IAAIqC,EAAQhD,EAERgD,GAAS,GAAKA,EAAQzC,EAAQ9H,OAC1B4I,EAAEO,OAAS,EACPoB,IAAUhD,IACVC,EAAeM,EAASP,EAAoB,GAC5CT,KAIAyD,IAAUhD,IACVC,EAAeM,EAASP,EAAoB,GAC5CT,MAMRyD,EAAQhD,EACRC,EAAeM,EAASP,GACxBT,KAGJ,OAAO,GCcgB0D,CAAY5B,OAG3B,wBAAIgB,GAAG,YAEP,4BAAQa,QAAS,WD+C7B5C,EADgB,yGC9CJ,QAIA,6BACI,4BAAQ4C,QAAS,YCxFrC,WACI,IAAMC,EAAYvD,YAClBA,UAAyBuD,GACzBvD,gBAA+B,QAAS,CAACwD,gBAAiB,IDsFtCC,KADJ,SADJ,WAMI,4BAAQH,QAAS,YCvFrC,WACI,IAAMI,EAAa1D,aACnBA,UAAyB0D,GACzB1D,gBAA+B,SAAU,CAACwD,gBAAiB,IDqFvCG,KADJ,UANJ,WAWI,4BAAQL,QAAS,YC9BrC,WACI,IAAMM,EAAoB5D,oBAC1BA,UAAyB4D,GACzB5D,gBAA+B,gBAAiB,CAACwD,gBAAiB,ID4B9CK,KADJ,UAXJ,WAgBI,4BAAQP,QAAS,YC7BrC,WACI,IAAMQ,EAAmB9D,mBACzBA,UAAyB8D,GACzB9D,gBAA+B,eAAgB,CAACwD,gBAAiB,ID2B7CO,KADJ,aAhBJ,WAqBI,4BAAQT,QAAS,YChGrC,WACI,IAAMU,EAAahE,aACnBA,UAAyBgE,GACzBhE,gBAA+B,SAAU,CAACwD,gBAAiB,ID8FvCS,KADJ,SArBJ,WA0BI,4BAAQX,QAAS,YC/FrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cACxCoJ,EAAQmG,MAAMrE,MAAQ,QACtB9B,EAAQmG,MAAMpE,OAAS,QACvBrJ,SAAmBsH,GD4FCoG,KADJ,WA1BJ,WA+BI,4BAAQb,QAAS,YC7FrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cACxCoJ,EAAQmG,MAAMrE,MAAQ,QACtB9B,EAAQmG,MAAMpE,OAAS,QACvBrJ,SAAmBsH,GD0FCqG,KADJ,WA/BJ,YAqCA,6BACI,4BAAQd,QAAS,YC5FrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cAClC8L,EAAWhK,cAAwBsH,GACzC0C,EAAS4D,QAAU5D,EAAS4D,OAC5B5N,cAAwBsH,EAAS0C,GDyFb6D,KADJ,iBADJ,WAMI,4BAAQhB,QAAS,YC1FrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cAClC8L,EAAWhK,cAAwBsH,GACzC0C,EAAS8D,kBAAoB9D,EAAS8D,iBACtC9N,cAAwBsH,EAAS0C,GDuFb+D,KADJ,wBANJ,WAWI,4BAAQlB,QAAS,YCxFrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cAClC8L,EAAWhK,cAAwBsH,GACzC0C,EAASgE,OAAShE,EAASgE,MAC3BhO,cAAwBsH,EAAS0C,GDqFbiE,KADJ,mBAXJ,WAgBI,4BAAQpB,QAAS,YCtFrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cAClC8L,EAAWhK,cAAwBsH,GACzC0C,EAASkE,OAASlE,EAASkE,MAC3BlO,cAAwBsH,EAAS0C,GDmFbmE,KADJ,iBAhBJ,WAqBI,4BAAQtB,QAAS,YCpFrC,WACI,IAAMvF,EAAUrJ,SAASC,eAAe,cAClC8L,EAAWhK,cAAwBsH,GACzC0C,EAASoE,UAAY,GACrBpO,cAAwBsH,EAAS0C,GDiFbqE,KADJ,aArBJ,YA4BA,6BACI,4BACI,8DACA,8DACA,uDACA,2DACA,iEAKR,6BACI,yBAAK9M,MAAM,QACP,yBAAKyK,GAAG,oBAAoBC,UAAU,UACjCqC,cAAc,eAAeC,QAAS,SAACvD,MAExC,yBAAKgB,GAAG,aAAaC,UAAU,kBAC1BuC,IAAK,SAAAC,GACD,EAAKnH,QAAUmH,IAEpB,4BAAQzC,GAAG,WAAWC,UAAW,SAAU7C,MAAO,IAAKC,OAAQ,OAEnE,qCAAK2C,GAAG,UAAUC,UAAU,WAA5B,YAAgD,WAAhD,8BAIA,qCAAKD,GAAG,WAAWC,UAAU,WAA7B,YAAiD,YAAjD,cAGA,qCAAKD,GAAG,aAAaC,UAAU,WAA/B,YAAmD,cAAnD,UAGA,qCAAKD,GAAG,cAAcC,UAAU,WAAhC,YAAoD,eAApD,YAMZ,yBAAKA,UAAU,SACX,6BAAK,0BAAMD,GAAG,YACd,6BAAK,0BAAMA,GAAG,eAAT,UAEL,6BAAK,0BAAMA,GAAG,gBACd,6BAAK,0BAAMA,GAAG,gBAEd,6BAAK,0BAAMA,GAAG,WAAT,kBACL,6BAAK,0BAAMA,GAAG,YAAT,gBACL,6BAAK,0BAAMA,GAAG,eAAT,oBAEL,6BAAK,0BAAMA,GAAG,WAAT,mBACL,6BACI,wBAAIA,GAAG,MAAP,gCAGR,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAChJ,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BAAS,6BA8CtD,6BACI,yBAAKC,UAAU,QACX,yBAAKD,GAAG,UAAUC,UAAU,uBACxB,yBAAKD,GAAG,eAAR,kCAGA,wBAAIA,GAAG,cAIX,yBAAKC,UAAU,QACX,yBAAKA,UAAU,aACX,yBAAKD,GAAG,YACJ,yBAAKC,UAAU,eACX,yCAMpB,6BAAS,6BACT,yBAAKA,UAAU,SACX,yBAAKA,UAAU,QACX,yBAAKA,UAAU,aACX,yBAAKD,GAAG,aACJ,yBAAKC,UAAU,eACX,uD,GA3QXyC,IAAMC,WElBpBC,E,uKAPX,OAAO,6BACL,kBAAC,EAAD,W,GAHYF,IAAMC,WCOJE,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFnR,SAASC,eAAe,SDyHpB,kBAAmBmR,WACrBA,UAAUC,cAAc/I,MACrBwD,MAAK,SAAAwF,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAMxI,c","file":"static/js/main.b703ce70.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","import React from \"react\";\r\n\r\nfunction dicomParse(image) {\r\n    try {\r\n        // print the dicom information\r\n        document.getElementById('patient').textContent = 'Patient ID : ' + image.data.string('x00100020');\r\n        document.getElementById('topleft').textContent = 'Patient Name : ' + image.data.string('x00100010') + '\\n' + 'Patient Sex : ' + image.data.string('x00100040');\r\n        document.getElementById('topright').textContent = 'Modality : ' + image.data.string('x00080060');\r\n        document.getElementById('modality').textContent = 'Modality : ' + image.data.string('x00080060');\r\n        document.getElementById('instanceUID').textContent = 'Instance UID : ' + image.data.string('x00080018');\r\n\r\n        /*\r\n        document.getElementById('studyUID').textContent = 'Study UID : ' + image.data.string('x0020000d');\r\n        document.getElementById('seriesUID').textContent = 'Series UID : ' + image.data.string('x0020000e');\r\n        document.getElementById('instanceUID').textContent = 'Instance UID : ' + image.data.string('x00080018');\r\n        document.getElementById('frameUID').textContent = 'Frame of Reference UID : ' + image.data.string('x00200052');\r\n\r\n        document.getElementById('imageOrientation').textContent = 'Image Orientation : ' + image.data.string('x00200037');\r\n        document.getElementById('pixelSpacing').textContent = 'Pixel Spacing : ' + image.data.string('x00280030');\r\n        document.getElementById('imagePosition').textContent = 'Image Position : ' + image.data.string('x00200032');\r\n         */\r\n\r\n    } catch (ex) {\r\n        alert('parsing error');\r\n    }\r\n}\r\n\r\nexport default dicomParse;\r\n","import React from \"react\";\r\nimport * as cornerstone from \"cornerstone-core\";\r\n\r\n//caculate voxel from pixel\r\nfunction voxelCal(image) {\r\n    let modality = image.data.string('x00080060');\r\n    if (modality === ('CT')) {\r\n        let imgPos = image.data.string('x00200032');\r\n        let imgPosArr = imgPos.split(\"\\\\\");\r\n\r\n        let Sx = (parseFloat(imgPosArr[0]) * 10) / 10;\r\n        let Sy = (parseFloat(imgPosArr[1]) * 10) / 10;\r\n        let Sz = (parseFloat(imgPosArr[2]) * 10) / 10;\r\n\r\n        let imgOri = image.data.string('x00200037');\r\n        imgOri = imgOri.toString();\r\n        let imgOriArr = imgOri.split(\"\\\\\");\r\n\r\n        let Xx = (parseFloat(imgOriArr[0]) * 10) / 10;\r\n        let Xy = (parseFloat(imgOriArr[1]) * 10) / 10;\r\n        let Xz = (parseFloat(imgOriArr[2]) * 10) / 10;\r\n        let Yx = (parseFloat(imgOriArr[3]) * 10) / 10;\r\n        let Yy = (parseFloat(imgOriArr[4]) * 10) / 10;\r\n        let Yz = (parseFloat(imgOriArr[5]) * 10) / 10;\r\n\r\n        let pixelSpace = image.data.string('x00280030');\r\n        pixelSpace = pixelSpace.toString();\r\n        let pixelSpaceArr = pixelSpace.split(\"\\\\\");\r\n\r\n        let Di = parseFloat((pixelSpaceArr[0]) * 10) / 10;\r\n        let Dj = parseFloat((pixelSpaceArr[1]) * 10) / 10;\r\n\r\n        let el = document.getElementById('dicomImage');\r\n\r\n        /*\r\n        document.getElementById('Sxyz').textContent = 'Sx : ' + Sx + ', Sy : ' + Sy + ', Sz : ' + Sz;\r\n        document.getElementById('Xxyz').textContent = 'Xx : ' + Xx + ', Xy : ' + Xy + ', Xz : ' + Xz;\r\n        document.getElementById('Yxyz').textContent = 'Yx : ' + Yx + ', Yy : ' + Yy + ', Yz : ' + Yz;\r\n        document.getElementById('Dij').textContent = 'Di : ' + Di + ', Dj : ' + Dj;\r\n         */\r\n\r\n        el.addEventListener('mousemove', function (event) {\r\n            const pixelCoords = cornerstone.pageToPixel(el, event.pageX, event.pageY);\r\n            document.getElementById('coords').textContent = \"pageX=\" + event.pageX + \", pageY=\" + event.pageY + \", pixelX=\" + pixelCoords.x + \", pixelY=\" + pixelCoords.y;\r\n\r\n            let Px = (Xx * Di * pixelCoords.x) + (Yx * Dj * pixelCoords.y) + Sx;\r\n            let Py = (Xy * Di * pixelCoords.x) + (Yy * Dj * pixelCoords.y) + Sy;\r\n            let Pz = (Xz * Di * pixelCoords.x) + (Yz * Dj * pixelCoords.y) + Sz;\r\n\r\n            Px = Math.floor(Px * 10) / 10;\r\n            Py = Math.floor(Py * 10) / 10;\r\n            Pz = Math.floor(Pz * 10) / 10;\r\n            document.getElementById('voxelCoords').textContent = \"Px = \" + Px + \", Py = \" + Py + \", Pz = \" + Pz;\r\n        });\r\n\r\n        el.addEventListener('dblclick', function (event) {\r\n            const pixelCoords = cornerstone.pageToPixel(el, event.pageX, event.pageY);\r\n            document.getElementById('pixelValue').textContent = \"pageX=\" + event.pageX + \", pageY=\" + event.pageY + \", pixelX=\" + pixelCoords.x + \", pixelY=\" + pixelCoords.y;\r\n\r\n            let Px = (Xx * Di * pixelCoords.x) + (Yx * Dj * pixelCoords.y) + Sx;\r\n            let Py = (Xy * Di * pixelCoords.x) + (Yy * Dj * pixelCoords.y) + Sy;\r\n            let Pz = (Xz * Di * pixelCoords.x) + (Yz * Dj * pixelCoords.y) + Sz;\r\n\r\n            Px = Math.floor(Px * 10) / 10;\r\n            Py = Math.floor(Py * 10) / 10;\r\n            Pz = Math.floor(Pz * 10) / 10;\r\n\r\n            document.getElementById('voxelValue').textContent = \"Px = \" + Px + \", Py = \" + Py + \", Pz = \" + Pz;\r\n        });\r\n        return [Sx, Sy, Di, Dj]\r\n    } else {\r\n        alert('NOT CT IMAGES')\r\n    }\r\n\r\n}\r\n\r\nexport default voxelCal;\r\n","let struct;\r\n\r\n// open text file ( include dicom contour data )\r\nfunction readTextFile(file) {\r\n    struct = String();\r\n\r\n    var rawFile = new XMLHttpRequest();\r\n    rawFile.open(\"GET\", file, false);\r\n\r\n    rawFile.onreadystatechange = function () {\r\n        if (rawFile.readyState === 4) {\r\n            if (rawFile.status === 200 || rawFile.status === 0) {\r\n                var allText = rawFile.responseText;\r\n                struct = allText;\r\n            }\r\n        }\r\n\r\n    };\r\n    rawFile.send(null);\r\n    return struct\r\n}\r\n\r\nexport default readTextFile\r\n","function addCheckbox(ROI_LIST_Array) {\r\n    ROI_LIST_Array.forEach(function (n) {\r\n        let ul = document.getElementById('ul');\r\n        let li = document.createElement('li');\r\n\r\n        let checkbox = document.createElement('input');\r\n        checkbox.type = 'checkbox';\r\n        checkbox.value = n.x30060022;\r\n        checkbox.name = 'roi';\r\n        checkbox.class = 'roiSet';\r\n\r\n        li.append(checkbox);\r\n\r\n        let text = n.x30060026;\r\n        li.append(document.createTextNode(text));\r\n        ul.append(li);\r\n    });\r\n\r\n}\r\nexport default addCheckbox;\r\n","import voxelCal from \"./pixel2voxel\";\r\n\r\nfunction isASCII(str) {\r\n    return /^[\\x00-\\x7F]*$/.test(str);\r\n}\r\n\r\n//Convert Parsed contour data to Array\r\nfunction pixelCal(image, struct) {\r\n    let str = struct.split(\"\\\\\");\r\n\r\n    let vPx = []; //contour Data Px (voxel point x )\r\n    let vPy = []; //contour Data Py (voxel point y )\r\n    let vPz = []; //contour Data Pz (voxel point z )\r\n\r\n    //document.getElementById('str').textContent = \"str : \" + str;\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (i % 3 === 0) {\r\n            vPx[i] = str[i];\r\n        } else if (i % 3 === 1) {\r\n            vPy[i] = str[i];\r\n        } else if (i % 3 === 2) {\r\n            vPz[i] = str[i];\r\n        }\r\n    }\r\n    //document.getElementById('vPx').textContent = \"vPx : \" + vPx;\r\n    // document.getElementById('vPy').textContent = \"vPy : \" + vPy;\r\n\r\n    let voxel = voxelCal(image);\r\n    let Sx = voxel[0];\r\n    let Sy = voxel[1];\r\n    let Di = voxel[2];\r\n    let Dj = voxel[3];\r\n\r\n    let pi = [];\r\n    let pj = [];\r\n\r\n    //convert voxel vPx,vPy to pixel pi,pj\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (i % 3 === 0) {\r\n            pi[i] = Math.floor(((vPx[i] - Sx) / (Di)) * 10) / 10;\r\n        } else if (i % 3 === 1) {\r\n            pj[i] = Math.floor(((vPy[i] - Sy) / (Dj)) * 10) / 10;\r\n        }\r\n    }\r\n\r\n    /*\r\n    document.getElementById('vPx').textContent = \"vPx : \" + vPx;\r\n    document.getElementById('vPy').textContent = \"vPy : \" + vPy;\r\n\r\n    document.getElementById('pi').textContent = \"Pi : \" + pi;\r\n    document.getElementById('pj').textContent = \"Pj : \" + pj;\r\n    */\r\n    return [pi, pj]\r\n};\r\nexport default pixelCal\r\n","import $ from \"jquery\";\r\nimport dicomParser from \"dicom-parser\";\r\nimport addCheckbox from \"./checkbox\";\r\nimport pixelCal from \"./voxel2pixel\";\r\nimport fullColorHex from \"./rgbToHex.js\";\r\n\r\nfunction isASCII(str) {\r\n    return /^[\\x00-\\x7F]*$/.test(str);\r\n}\r\n\r\nlet dataSet;\r\n\r\nfunction structFile(file) {\r\n    // clear any data currently being displayed as we parse this next file\r\n    document.getElementById('rtstruct').innerHTML = '';\r\n    document.getElementById('rtstruct3').innerHTML = '';\r\n\r\n    $('#status').removeClass('alert-warning alert-success alert-danger').addClass('alert-info');\r\n    $('#warnings').empty();\r\n    document.getElementById('statusText2').innerHTML = 'Status: Loading file, please wait..';\r\n\r\n    let reader = new FileReader();\r\n    reader.onload = function (file) {\r\n        let arrayBuffer = reader.result;\r\n        // Here we have the file data as an ArrayBuffer.  dicomParser requires as input a\r\n        // Uint8Array so we create that here\r\n        let byteArray = new Uint8Array(arrayBuffer);\r\n\r\n        let kb = byteArray.length / 1024;\r\n        let mb = kb / 1024;\r\n        let byteStr = mb > 1 ? mb.toFixed(3) + \" MB\" : kb.toFixed(0) + \" KB\";\r\n\r\n        document.getElementById('statusText2').innerHTML = 'Status: Parsing ' + byteStr + ' bytes, please wait..';\r\n\r\n\r\n        // set a short timeout to do the parse so the DOM has time to update itself with the above message\r\n        setTimeout(function () {\r\n            // Invoke the paresDicom function and get back a DataSet object with the contents\r\n            try {\r\n                let start = new Date().getTime();\r\n                dataSet = dicomParser.parseDicom(byteArray);\r\n\r\n                let output1 = [];\r\n                let output3 = [];\r\n\r\n                ROIList(dataSet);\r\n                contour(dataSet, output1, output3);\r\n                roiJson(roi_List);\r\n                contourJson(contourList);\r\n\r\n                check();\r\n                // Combine the array of strings into one string and add it to the DOM\r\n                document.getElementById('rtstruct').innerHTML = '<ul>' + output1.join('') + '</ul>';\r\n                document.getElementById('rtstruct3').innerHTML = '<ul>' + output3.join('') + '</ul>';\r\n\r\n                let end = new Date().getTime();\r\n                let time = end - start;\r\n                if (dataSet.warnings.length > 0) {\r\n                    $('#status1').removeClass('alert-success alert-info alert-danger').addClass('alert-warning');\r\n                    $('#statusText2').html('Status: Warnings encountered while parsing file (file of size ' + byteStr + ' parsed in ' + time + 'ms)');\r\n\r\n                    dataSet.warnings.forEach(function (warning) {\r\n                        $(\"#warnings\").append('<li>' + warning + '</li>');\r\n                    });\r\n                } else {\r\n                    let pixelData = dataSet.elements.x7fe00010;\r\n                    if (pixelData) {\r\n                        $('#status1').removeClass('alert-warning alert-info alert-danger').addClass('alert-success');\r\n                        $('#statusText').html('Status: Ready (file of size ' + byteStr + ' parsed in ' + time + 'ms)');\r\n                    } else {\r\n                        $('#status1').removeClass('alert-warning alert-info alert-danger').addClass('alert-success');\r\n                        $('#statusText2').html('Status: Ready - no pixel data found (file of size ' + byteStr + ' parsed in ' + time + 'ms)');\r\n                    }\r\n                }\r\n\r\n            } catch (err) {\r\n                let message = err;\r\n                if (err.exception) {\r\n                    message = err.exception;\r\n                }\r\n                $('#status').removeClass('alert-success alert-info alert-warning').addClass('alert-danger');\r\n                document.getElementById('statusText2').innerHTML = 'Status: Error - ' + message + ' (file of size ' + byteStr + ' )';\r\n\r\n                if (err.output1 || err.output3) {\r\n                    document.getElementById('rtstruct').innerHTML = '<ul>' + output1.join('') + '</ul>';\r\n                    document.getElementById('rtstruct3').innerHTML = '<ul>' + output3.join('') + '</ul>';\r\n                } else if (err.dataSet) {\r\n                    var output1 = [];\r\n                    var output3 = [];\r\n\r\n                    ROIList(err.dataSet);\r\n                    contour(err.dataSet, output1, output3);\r\n                    document.getElementById('rtstruct').innerHTML = '<ul>' + output1.join('') + '</ul>';\r\n                    document.getElementById('rtstruct3').innerHTML = '<ul>' + output3.join('') + '</ul>';\r\n                }\r\n            }\r\n        }, 10);\r\n    };\r\n    reader.readAsArrayBuffer(file);\r\n\r\n    return dataSet;\r\n}\r\n\r\nlet roi_List = [];\r\n\r\nfunction ROIList(dataSet) {\r\n    try {\r\n        for (let propertyName in dataSet.elements) {\r\n\r\n            let element = dataSet.elements[propertyName];\r\n\r\n            //show ROI List\r\n            if (element.tag === 'x30060020' || (element.tag === 'x30060022') || element.tag === 'x30060026') {\r\n                let text = element.tag;\r\n                if (element.hadUndefinedLength) {\r\n                    text += \" <strong>(-1)</strong>\";\r\n                }\r\n                text += \"; \";\r\n                if (element.vr) {\r\n                    text += \" VR=\" + element.vr + \"; \";\r\n                }\r\n                let color = 'black';\r\n\r\n                if (element.items) { //item들을 표시\r\n                    element.items.forEach(function (item) {\r\n                        // each item contains its own data set so we iterate over the items and recursively call this function\r\n                        ROIList(item.dataSet);\r\n                    });\r\n                } else if (element.fragments) {\r\n                    // each item contains its own data set so we iterate over the items and recursively call this function\r\n                    let itemNumber = 0;\r\n                    element.fragments.forEach(function (fragment) {\r\n                        let basicOffset;\r\n                        if (element.basicOffsetTable) {\r\n                            basicOffset = element.basicOffsetTable[itemNumber];\r\n                        }\r\n                        let str = '<li>Fragment #' + itemNumber++ + ' offset = ' + fragment.offset;\r\n                        str += '(' + basicOffset + ')';\r\n                        str += '; length = ' + fragment.length + '</li>';\r\n                    });\r\n                } else {\r\n                    if (element.length === 2) {\r\n                        text += \" (\" + dataSet.uint16(propertyName) + \")\";\r\n\r\n                    } else if (element.length === 4) {\r\n                        text += \" (\" + dataSet.uint32(propertyName) + \")\";\r\n                    }\r\n                    //대부분은 문자열이지만 그렇지 않은 것들을 확인해서 표시하는 것을 위함\r\n                    let str = dataSet.string(propertyName);\r\n                    let stringIsAscii = isASCII(str);\r\n\r\n                    if (stringIsAscii) {\r\n                        // 정의되지 않은 경우 아무것도 넣지 않음\r\n                        if (str !== undefined) {\r\n                            text += '\"' + str + '\"';\r\n                        }\r\n                    } else {\r\n                        if (element.length !== 2 && element.length !== 4) {\r\n                            color = '#C8C8C8';\r\n                            // If it is some other length and we have no string\r\n                            text += \"<i>binary data</i>\";\r\n                        }\r\n                    }\r\n                    if (element.length === 0) {\r\n                        color = '#C8C8C8';\r\n                    }\r\n                    roi_List.push(element.tag, dataSet.string(propertyName));\r\n                }\r\n            }\r\n        }\r\n    } catch (err) {\r\n        let ex = {\r\n            exception: err\r\n        }\r\n        throw ex;\r\n    }\r\n}\r\n\r\nlet contourList = [];\r\n\r\nfunction contour(dataSet, output1, output3) {\r\n    try {\r\n        for (let propertyName in dataSet.elements) {\r\n            let element = dataSet.elements[propertyName];\r\n            //show contour data list\r\n\r\n            if (element.tag === 'x30060039' || element.tag === 'x3006002a' || element.tag === 'x30060040' || element.tag === 'x30060050' || element.tag === 'x30060016' || element.tag === 'x00081155' || element.tag === 'x30060084') {\r\n                let text = element.tag;\r\n\r\n                if (element.hadUndefinedLength) {\r\n                    text += \" <strong>(-1)</strong>\";\r\n                }\r\n                text += \"; \";\r\n                if (element.vr) {\r\n                    text += \" VR=\" + element.vr + \"; \";\r\n                }\r\n                let color = 'black';\r\n\r\n                // Here we check for Sequence items and iterate over them if present.\r\n                // items will not be set in the element object for elements that don't have SQ VR type.\r\n                //  Note that implicit little endian sequences will are currently not parsed.\r\n                if (element.items) { //item들을 표시\r\n                    let itemNumber = 0;\r\n                    element.items.forEach(function (item) {\r\n                        // each item contains its own data set so we iterate over the items and recursively call this function\r\n                        //   output1.push('<li class = \"item\">Item #' + itemNumber++ + ' ' + item.tag + '</li>')\r\n                        //   output1.push('<ul class = \"data\">');\r\n                        contour(item.dataSet, output1, output3);\r\n\r\n                        // output1.push('</ul>');\r\n                    });\r\n                } else if (element.fragments) {\r\n                    // each item contains its own data set so we iterate over the items and recursively call this function\r\n                    let itemNumber = 0;\r\n                    element.fragments.forEach(function (fragment) {\r\n                        let basicOffset;\r\n                        if (element.basicOffsetTable) {\r\n                            basicOffset = element.basicOffsetTable[itemNumber];\r\n                        }\r\n                        let str = '<li>Fragment #' + itemNumber++ + ' offset = ' + fragment.offset;\r\n                        str += '(' + basicOffset + ')';\r\n                        str += '; length = ' + fragment.length + '</li>';\r\n                    });\r\n                } else {\r\n                    if (element.length === 2) {\r\n                        text += \" (\" + dataSet.uint16(propertyName) + \")\";\r\n\r\n                    } else if (element.length === 4) {\r\n                        text += \" (\" + dataSet.uint32(propertyName) + \")\";\r\n                    }\r\n                    //대부분은 문자열이지만 그렇지 않은 것들을 확인해서 표시하는 것을 위함\r\n                    let str = dataSet.string(propertyName);\r\n                    let stringIsAscii = isASCII(str);\r\n\r\n                    if (stringIsAscii) {\r\n                        // 정의되지 않은 경우 아무것도 넣지 않음\r\n                        if (str !== undefined) {\r\n                            text += '\"' + str + '\"';\r\n                        }\r\n                    } else {\r\n                        if (element.length !== 2 && element.length !== 4) {\r\n                            color = '#C8C8C8';\r\n                            // If it is some other length and we have no string\r\n                            text += \"<i>binary data</i>\";\r\n                        }\r\n                    }\r\n                    if (element.length === 0) {\r\n                        color = '#C8C8C8';\r\n                    }\r\n                    //   output3.push('<li style=\"color:' + color + ';\">' + text + '</li>');\r\n                    // output1.push('<li style=\"color:' + color + ';\">' + text + '</li>');\r\n                    // finally we add the string to our  array\r\n                    contourList.push(element.tag, dataSet.string(propertyName));\r\n                }\r\n            }\r\n        }\r\n    } catch (err) {\r\n        let ex = {\r\n            exception: err,\r\n            output3: output3\r\n        }\r\n        throw ex;\r\n    }\r\n    return contourList;\r\n}\r\n\r\nfunction roiJson(roi_List) {\r\n    let ROI_Number = [];\r\n    let ROI_Name = [];\r\n\r\n    for (let i = 0; i < roi_List.length; i++) {\r\n        if (roi_List[i] == 'x30060022') {\r\n            ROI_Number[i] = roi_List[i + 1];\r\n        } else if (roi_List[i] == 'x30060026') {\r\n            ROI_Name[i] = roi_List[i + 1];\r\n        }\r\n    }\r\n\r\n    //remove undefined in array\r\n    ROI_Number = ROI_Number.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    })\r\n    ROI_Name = ROI_Name.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    })\r\n\r\n    //parsing to JSON\r\n    $(function () {\r\n        var ROI_LIST_Array = new Array();\r\n\r\n        for (let i = 0; i < ROI_Name.length; i++) {\r\n            let ROI_object = new Object();\r\n            ROI_object.x30060022 = ROI_Number[i];\r\n            ROI_object.x30060026 = ROI_Name[i];\r\n\r\n            ROI_LIST_Array.push(ROI_object);\r\n        }\r\n        addCheckbox(ROI_LIST_Array);\r\n    });\r\n}\r\n\r\nlet contour_data_Array = new Array();\r\n\r\nfunction contourJson(contourList) {\r\n    let Referenced_Instance_UID = [];\r\n    let contour_data = [];\r\n    let Referenced_ROI_Number = [];\r\n    let ROI_display_color = [];\r\n\r\n    for (let i = 0; i < contourList.length; i++) {\r\n        let j = 0;\r\n\r\n\r\n        if (contourList[i + 2] == 'x00081155') {\r\n            Referenced_Instance_UID[i] = contourList[i + 3];\r\n            contour_data[i] = contourList[i + 5];\r\n            if (contourList[i + 6] == 'x30060084') {\r\n                Referenced_ROI_Number[i] = contourList[i + 7];\r\n            } else if (contourList[i + 6] == 'x00081155') {\r\n                for (j = i + 6; j < contourList.length; j++) {\r\n                    if (contourList[j + 2] == 'x30060084') {\r\n                        Referenced_ROI_Number[i] = contourList[j + 3];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (contourList[i] == 'x3006002a') {\r\n                ROI_display_color[i] = contourList[i + 1];\r\n            } else if (contourList[i] == 'x30060050') {\r\n                for (j = i; j > 0; j--) {\r\n                    if (contourList[j] == 'x3006002a') {\r\n                        ROI_display_color[i] = contourList[j + 1];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    ROI_display_color = ROI_display_color.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    });\r\n    Referenced_Instance_UID = Referenced_Instance_UID.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    });\r\n    contour_data = contour_data.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    });\r\n    Referenced_ROI_Number = Referenced_ROI_Number.filter(function (item) {\r\n        return item !== null && item !== undefined && item !== \"\";\r\n    });\r\n\r\n    //parsing to JSON\r\n    $(function () {\r\n        for (let i = 0; i < contourList.length; i++) {\r\n            let contour_object = new Object();\r\n            contour_object.x30060084 = Referenced_ROI_Number[i];\r\n            contour_object.x00081155 = Referenced_Instance_UID[i];\r\n            contour_object.x30060050 = contour_data[i];\r\n            contour_object.x3006002a = ROI_display_color[i];\r\n\r\n            contour_data_Array.push(contour_object);\r\n        }\r\n    });\r\n}\r\n\r\nlet struct, color;\r\nlet checkVal = 13;\r\n\r\nfunction sendImage(image) {\r\n    let Instance_UID = 0;\r\n    Instance_UID = image.data.string('x00080018');\r\n\r\n    for (let i = 0; i < contour_data_Array.length; i++) {\r\n        if (contour_data_Array[i]['x30060084'] == checkVal) {\r\n            if (contour_data_Array[i]['x00081155'] == Instance_UID) {\r\n                struct = contour_data_Array[i]['x30060050'];\r\n                color = contour_data_Array[i]['x3006002a'];\r\n\r\n                draw(image, struct, color);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n}\r\n\r\n//draw ROI contouring from textFile\r\nlet canvas;\r\nlet ctx;\r\n\r\nfunction draw(image, struct, color) {\r\n    let px = pixelCal(image, struct);\r\n    let pi = px[0];\r\n    let pj = px[1];\r\n\r\n    canvas = document.getElementById(\"myCanvas\");\r\n    ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(pi[0], pj[1]);\r\n    for (let i = 1; i <= pi.length * 3; i++) {\r\n        if (i % 3 === 0) {\r\n            ctx.lineTo(pi[i], pj[i + 1]);\r\n        }\r\n    }\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.fillStyle = fullColorHex(color);\r\n    ctx.globalAlpha = 0.7;\r\n    ctx.fill();\r\n\r\n    return canvas;\r\n}\r\n\r\nfunction reset() {\r\n    canvas = document.getElementById(\"myCanvas\");\r\n    ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\n\r\nfunction check() {\r\n    $(document).ready(function () {\r\n        $(':checkbox[name=\"roi\"]').click(function () {\r\n            if (!$(\".roi\").prop('checked')) {\r\n                alert(\"체크박스 체크했음!\");\r\n                $(\".roi\").prop('checked', true);\r\n            } else {\r\n                $(\".roi\").prop('checked', false);\r\n                alert(\"체크박스 체크 해제!\");\r\n            }\r\n        });\r\n    });\r\n\r\n}\r\n\r\nexport {structFile, sendImage, draw, reset}\r\n","var rgbToHex = function (color) {\r\n    var hex = Number(color).toString(16);\r\n    if (hex.length < 2) {\r\n        hex = \"0\" + hex;\r\n    }\r\n    return hex;\r\n};\r\n\r\nvar fullColorHex = function (rgb) {\r\n    rgb = rgb.split('\\\\');\r\n\r\n    let r = rgb[0];\r\n    let g = rgb[1];\r\n    let b = rgb[2];\r\n\r\n    var red = rgbToHex(r);\r\n    var green = rgbToHex(g);\r\n    var blue = rgbToHex(b);\r\n\r\n    return \"#\" + red + green + blue;\r\n};\r\n\r\nexport default fullColorHex\r\n","import dicomParse from \"./dicomParse\";\r\nimport dicomParser from \"dicom-parser\";\r\nimport Hammer from \"hammerjs\";\r\nimport * as cornerstone from \"cornerstone-core\";\r\nimport * as cornerstoneTools from \"cornerstone-tools\";\r\nimport * as cornerstoneMath from \"cornerstone-math\"\r\nimport * as cornerstoneWadoImageLoader from \"cornerstone-wado-image-loader\"\r\nimport voxelCal from \"./pixel2voxel\";\r\nimport readTextFile from \"./openFile\";\r\nimport {structFile, sendImage, reset} from \"./ROI\";\r\n\r\ncornerstoneWadoImageLoader.external.cornerstone = cornerstone\r\ncornerstoneWadoImageLoader.external.dicomParser = dicomParser\r\ncornerstoneTools.external.cornerstone = cornerstone\r\ncornerstoneTools.external.Hammer = Hammer;\r\ncornerstoneTools.external.cornerstoneMath = cornerstoneMath\r\ncornerstoneTools.init();\r\n\r\nlet currentImageIndex = 72;\r\n\r\n//Import a list of file names from a selected folder\r\nfunction imageIdList(e) {\r\n    let imageId = []; //image ID list from file name list\r\n    let dumpFiles = [];\r\n    let max = 1000000;\r\n    /*\r\n      let output = document.getElementById(\"listing\");\r\n      let files = e.target.files;\r\n\r\n   // show file list\r\n     for (let i=0; i<files.length; i++) {\r\n         let item = document.createElement(\"li\");\r\n         item.innerHTML = files[i].webkitRelativePath;\r\n         output.appendChild(item);\r\n     };\r\n    */\r\n    let cnt = 0;\r\n\r\n    for (let i = 0; i < max; i++) {\r\n        imageId[i] = cornerstoneWadoImageLoader.wadouri.fileManager.add(e.target.files[i]) //save file name in array\r\n        dumpFiles[i] = e.target.files[i];\r\n        if (cnt > max) {\r\n            alert('ERROR : There are Too many files.');\r\n        }\r\n        cnt++;\r\n    }\r\n\r\n    //Index 114 : RT STRUCTURE FILE\r\n    //Index 72 : initial CT Image\r\n    //dumpFile(dumpfiles[71]);\r\n    structFile(dumpFiles[113]);\r\n    updateTheImage(imageId, currentImageIndex);\r\n\r\n    let el = document.getElementById('dicomImage');\r\n    el.onwheel = wheelE;\r\n\r\n    function wheelE(e) {\r\n        // Firefox e.detail > 0 scroll back, < 0 scroll forward\r\n        // chrome/safari e.wheelDelta < 0 scroll back, > 0 scroll forward\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        let index = currentImageIndex;\r\n\r\n        if (index >= 0 || index < imageId.length) {\r\n            if (e.deltaY < 0) {\r\n                if (index === currentImageIndex) {\r\n                    updateTheImage(imageId, currentImageIndex + 1); //update images\r\n                    reset();\r\n                    // dumpFile(dumpfiles[currentImageIndex ]); // update dump\r\n                }\r\n            } else {\r\n                if (index === currentImageIndex) {\r\n                    updateTheImage(imageId, currentImageIndex - 1); //update images\r\n                    reset();\r\n                    //  dumpFile(dumpfiles[currentImageIndex]); // update dump\r\n\r\n                }\r\n            }\r\n        } else {\r\n            index = currentImageIndex;\r\n            updateTheImage(imageId, currentImageIndex); //update images\r\n            reset();\r\n        }\r\n        // Prevent page fom scrolling\r\n        return false;\r\n    }\r\n}\r\n\r\n\r\nlet img;\r\n\r\n// show image #1 initially\r\nfunction updateTheImage(imageIds, imageIndex) {\r\n    let el = document.getElementById('dicomImage');\r\n    cornerstone.enable(el)\r\n    currentImageIndex = imageIndex;\r\n    cornerstone.loadImage(imageIds[currentImageIndex]).then(function (image) {\r\n        const viewport = cornerstone.getDefaultViewportForImage(el, image);\r\n\r\n        if (image.data.string('x00080060') === 'CT' || image.data.string('x00080060') === 'ct' || image.data.string('x00080060') === 'MRI') {\r\n            cornerstone.displayImage(el, image, viewport);\r\n\r\n            dicomParse(image);\r\n            voxelCal(image);\r\n            sendImage(image);\r\n            img = image;\r\n        } else {\r\n            alert(\"ERROR: Confirm this image's modality : CT , MRI ... \");\r\n        }\r\n\r\n    });\r\n\r\n    return img;\r\n}\r\n\r\n\r\nfunction handleFileChange(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\r\n    let files = e.target.files;\r\n    // this UI is only built for a single file so just dump the first one\r\n    structFile(files[0]);\r\n    const imageId = cornerstoneWadoImageLoader.wadouri.fileManager.add(files[0]);\r\n    loadData(imageId);\r\n}\r\n\r\n//load one CT Image from local file\r\nfunction loadData(imageId) {\r\n    let el = document.getElementById('dicomImage');\r\n    cornerstone.enable(el)\r\n    cornerstone.loadImage(imageId).then(function (image) {\r\n        const viewport = cornerstone.getDefaultViewportForImage(el, image);\r\n        if (image.data.string('x00080060') === 'CT' || image.data.string('x00080060') === 'ct' || image.data.string('x00080060') === 'MRI') {\r\n            cornerstone.displayImage(el, image, viewport);\r\n\r\n            dicomParse(image);\r\n            voxelCal(image);\r\n            sendImage(image);\r\n            img = image;\r\n        } else {\r\n            alert(\"ERROR: Confirm this image's modality : CT , MRI ... \");\r\n        }\r\n    });\r\n    return img;\r\n}\r\n\r\n//open test file\r\nfunction handle() {\r\n    const imageId = 'dicomweb://s3.amazonaws.com/lury/PTCTStudy/1.3.6.1.4.1.25403.52237031786.3872.20100510032220.11.dcm';\r\n    loadData(imageId);\r\n}\r\n\r\n// this function gets called once the user drops the file onto the div\r\nfunction handleFileSelect(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n\r\n    // Get the FileList object that contains the list of files that were dropped\r\n    let files = evt.dataTransfer.files;\r\n\r\n    // this UI is only built for a single file so just dump the first one\r\n    structFile(files[0]);\r\n\r\n    const imageId = cornerstoneWadoImageLoader.wadouri.fileManager.add(files[0]);\r\n    loadData(imageId);\r\n}\r\n\r\n//this function manage drag event\r\nfunction handleDragOver(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.\r\n}\r\n\r\nexport {handleFileChange, handle, loadData, imageIdList, handleFileSelect, handleDragOver}\r\n","import React, {Component} from \"react\";\r\nimport * as cornerstone from \"cornerstone-core\";\r\nimport * as cornerstoneTools from \"cornerstone-tools\";\r\nimport * as cornerstoneMath from \"cornerstone-math\"\r\nimport * as cornerstoneWadoImageLoader from \"cornerstone-wado-image-loader\"\r\nimport Hammer from \"hammerjs\";\r\nimport dicomParser from \"dicom-parser\"\r\nimport \"./MainUI.css\"\r\nimport {\r\n    angleOn,\r\n    lengthOn,\r\n    eraserOn,\r\n    drawCircle,\r\n    drawRectangle,\r\n    reductionOn,\r\n    expansionOn,\r\n    invertOn,\r\n    interpolationOn,\r\n    hflipOn,\r\n    vflipOn,\r\n    rotateOn\r\n} from \"./buttonEventFunction.js\"\r\nimport {handleFileChange, handle, imageIdList, handleFileSelect, handleDragOver} from './loadData.js'\r\n\r\ncornerstoneWadoImageLoader.external.cornerstone = cornerstone\r\ncornerstoneWadoImageLoader.external.dicomParser = dicomParser\r\ncornerstoneTools.external.cornerstone = cornerstone\r\ncornerstoneTools.external.Hammer = Hammer;\r\ncornerstoneTools.external.cornerstoneMath = cornerstoneMath\r\ncornerstoneTools.init();\r\n\r\n\r\nclass MainUIElements extends React.Component {\r\n    componentDidMount() {\r\n        const element = this.element;\r\n\r\n        // Setup the dnd listeners.\r\n        let dropZone = document.getElementById('dicomImage');\r\n        dropZone.addEventListener('dragover', handleDragOver, false);\r\n        dropZone.addEventListener('drop', handleFileSelect, false);\r\n\r\n        element.addEventListener('mousedown', function (e) {\r\n            let lastX = e.pageX;\r\n            let lastY = e.pageY;\r\n            const mouseButton = e.which;\r\n\r\n            function mouseMoveHandler(e) {\r\n                const deltaX = e.pageX - lastX;\r\n                const deltaY = e.pageY - lastY;\r\n                lastX = e.pageX;\r\n                lastY = e.pageY;\r\n\r\n                if (mouseButton === 1) {\r\n                    let viewport = cornerstone.getViewport(element);\r\n                    viewport.voi.windowWidth += (deltaX / viewport.scale);\r\n                    viewport.voi.windowCenter += (deltaY / viewport.scale);\r\n                    cornerstone.setViewport(element, viewport);\r\n\r\n                    document.getElementById('bottomleft').textContent = \"WW/WC:\" + Math.round(viewport.voi.windowWidth)\r\n                        + \"/\" + Math.round(viewport.voi.windowCenter);\r\n\r\n                } else if (mouseButton === 2) {\r\n                    let viewport = cornerstone.getViewport(element);\r\n                    viewport.translation.x += (deltaX / viewport.scale);\r\n                    viewport.translation.y += (deltaY / viewport.scale);\r\n                    cornerstone.setViewport(element, viewport);\r\n\r\n                } else if (mouseButton === 3) {\r\n                    let viewport = cornerstone.getViewport(element);\r\n                    viewport.scale += (deltaY / 100);\r\n                    cornerstone.setViewport(element, viewport);\r\n                    document.getElementById('bottomright').textContent = \"Zoom:\" + viewport.scale + \"x\";\r\n                }\r\n            }\r\n\r\n            function mouseUpHandler() {\r\n                document.removeEventListener('mousemove', mouseMoveHandler);\r\n                document.removeEventListener('mouseup', mouseUpHandler);\r\n            }\r\n\r\n            document.addEventListener('mousemove', mouseMoveHandler);\r\n            document.addEventListener('mouseup', mouseUpHandler);\r\n        });\r\n\r\n    }\r\n\r\n    //Rendering\r\n    render() {\r\n        return (\r\n            <div id=\"outsideWrapper\" className={\"outsideWrapper\"}>\r\n                <div>File Select =>\r\n                    <input type=\"file\" onChange={(e) => {\r\n                        handleFileChange(e)\r\n                    }}/>&nbsp;&nbsp;\r\n                </div>\r\n                <div>Directory Select =>\r\n                    <input type=\"file\" id=\"filepicker\" name=\"fileList\" webkitdirectory={\"\"} directory={\"\"} multiple\r\n                           onChange={(e) => {\r\n                               imageIdList(e);\r\n                           }}/>\r\n                </div>\r\n                <ul id=\"listing\"></ul>\r\n\r\n                <button onClick={() => {\r\n                    handle()\r\n                }}>TEST\r\n                </button>\r\n                <div>\r\n                    <button onClick={() => {\r\n                        angleOn()\r\n                    }}>Angle\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        lengthOn()\r\n                    }}>Length\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        drawCircle()\r\n                    }}>Circle\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        drawRectangle()\r\n                    }}>Rectangle\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        eraserOn()\r\n                    }}>Erase\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        reductionOn()\r\n                    }}>256x256\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        expansionOn()\r\n                    }}>512x512\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                </div>\r\n                <div>\r\n                    <button onClick={() => {\r\n                        invertOn()\r\n                    }}>Toggle Invert\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        interpolationOn()\r\n                    }}>Toggle Interpolation\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        hflipOn()\r\n                    }}>Horizontal Flip\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        vflipOn()\r\n                    }}>Vertical Flip\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                    <button onClick={() => {\r\n                        rotateOn()\r\n                    }}>Rotate 90\r\n                    </button>\r\n                    &nbsp;&nbsp;\r\n                </div>\r\n\r\n                <div>\r\n                    <ul>\r\n                        <li>Left click drag - window/level</li>\r\n                        <li>Middle Mouse button drag - pan</li>\r\n                        <li>Right click drag - zoom</li>\r\n                        <li>Mouse wheel - scroll images</li>\r\n                        <li>Double Click - save pixel/voxel</li>\r\n                    </ul>\r\n                </div>\r\n\r\n\r\n                <div>\r\n                    <div class=\"left\">\r\n                        <div id=\"dicomImageWrapper\" className=\"wrapper\"\r\n                             onContextMenu=\"return false\" onWheel={(e) => {\r\n                        }}>\r\n                            <div id=\"dicomImage\" className=\"viewportElement\"\r\n                                 ref={input => {\r\n                                     this.element = input;\r\n                                 }}>\r\n                                <canvas id=\"myCanvas\" className={\"canvas\"} width={512} height={512}/>\r\n                            </div>\r\n                            <div id=\"topleft\" className=\"overlay\" className=\"topleft\">\r\n                                Patient Name:\r\n                                Patient Sex:\r\n                            </div>\r\n                            <div id=\"topright\" className=\"overlay\" className=\"topright\">\r\n                                Modality :\r\n                            </div>\r\n                            <div id=\"bottomleft\" className=\"overlay\" className=\"bottomleft\">\r\n                                WW/WC:\r\n                            </div>\r\n                            <div id=\"bottomright\" className=\"overlay\" className=\"bottomright\">\r\n                                Zoom:\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"right\">\r\n                    <div><span id=\"coords\"></span></div>\r\n                    <div><span id=\"voxelCoords\">voxel</span></div>\r\n\r\n                    <div><span id=\"pixelValue\"></span></div>\r\n                    <div><span id=\"voxelValue\"></span></div>\r\n\r\n                    <div><span id=\"patient\">Patient ID : </span></div>\r\n                    <div><span id=\"modality\">Modality : </span></div>\r\n                    <div><span id=\"instanceUID\">Instance UID : </span></div>\r\n\r\n                    <div><span id=\"contour\">contourData : </span></div>\r\n                    <div>\r\n                        <ul id=\"ul\">Structure Set ROI Sequence</ul>\r\n                    </div>\r\n                </div>\r\n                <br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>\r\n                <br></br><br></br><br></br><br></br><br></br><br></br><br></br>\r\n\r\n                {/*\r\n                < div class = \"patient INFO\">\r\n                    <div id=\"info\">\r\n                        <div><span id=\"studyUID\">Study UID :</span></div>\r\n                        <div><span id=\"seriesUID\">Series UID :</span></div>\r\n                        <div><span id=\"instanceUID\">Instance UID : </span></div>\r\n                        <div><span id=\"frameUID\">Frame of Reference UID : </span></div>\r\n                    </div>\r\n\r\n                    <br></br>\r\n                    <div id=\"voxel\">\r\n                        <div><span id=\"imageOrientation\">Image Orientation :</span></div>\r\n                        <div><span id=\"pixelSpacing\">Pixel Spacing :</span></div>\r\n                        <div><span id=\"imagePosition\">Image Position : </span></div>\r\n                    </div>\r\n                    <br></br>\r\n                    <div id=\"voxelCal\">\r\n                        <div><span id=\"Sxyz\"></span></div>\r\n                        <div><span id=\"Xxyz\"></span></div>\r\n                        <div><span id=\"Yxyz\"></span></div>\r\n                        <div><span id=\"Dij\"></span></div>\r\n\r\n                    </div>\r\n                    <br></br>\r\n                    <div id=\"pixelCal\">\r\n                        <div><span id=\"struct\">Struct :</span></div>\r\n                        <br></br>\r\n                        <div><span id=\"str\">str :</span></div>\r\n                        <br></br>\r\n                        <div><span id=\"vPx\">vPx : </span></div>\r\n                        <br></br>\r\n                        <div><span id=\"vPy\">vPy : </span></div>\r\n                    </div>\r\n                    <br></br>\r\n                    <div><span id=\"contour\">contour data :</span></div>\r\n\r\n                    <div id=\"point\">\r\n                        <div id=\"pi\">Pi :</div>\r\n                        <br></br>\r\n                        <div id=\"pj\">Pj :</div>\r\n                    </div>\r\n                </div>\r\n               */}\r\n\r\n                <div>\r\n                    <div className=\"left\">\r\n                        <div id=\"status1\" className=\"alert alert-success\">\r\n                            <div id=\"statusText2\">\r\n                                Status: Ready (no file loaded)\r\n                            </div>\r\n                            <ul id=\"warnings\">\r\n                            </ul>\r\n                        </div>\r\n\r\n                        <div className=\"row2\">\r\n                            <div className=\"col-md-12\">\r\n                                <div id=\"rtstruct\">\r\n                                    <div className=\"text-center\">\r\n                                        <h3>item</h3>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <br></br><br></br>\r\n                    <div className=\"right\">\r\n                        <div className=\"row2\">\r\n                            <div className=\"col-md-12\">\r\n                                <div id=\"rtstruct3\">\r\n                                    <div className=\"text-center\">\r\n                                        <h3>contour data</h3>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default MainUIElements\r\n","import \"./MainUI.css\"\r\nimport \"./MainUI.js\"\r\nimport * as cornerstoneTools from \"cornerstone-tools\";\r\nimport * as cornerstone from \"cornerstone-core\";\r\n\r\nexport {\r\n    angleOn,\r\n    lengthOn,\r\n    eraserOn,\r\n    drawCircle,\r\n    drawRectangle,\r\n    reductionOn,\r\n    expansionOn,\r\n    invertOn,\r\n    interpolationOn,\r\n    hflipOn,\r\n    vflipOn,\r\n    rotateOn\r\n}\r\n\r\nfunction angleOn() {\r\n    const AngleTool = cornerstoneTools.AngleTool;\r\n    cornerstoneTools.addTool(AngleTool)\r\n    cornerstoneTools.setToolActive('Angle', {mouseButtonMask: 1})\r\n}\r\n\r\nfunction lengthOn() {\r\n    const LengthTool = cornerstoneTools.LengthTool;\r\n    cornerstoneTools.addTool(LengthTool)\r\n    cornerstoneTools.setToolActive(\"Length\", {mouseButtonMask: 1})\r\n}\r\n\r\nfunction eraserOn() {\r\n    const EraserTool = cornerstoneTools.EraserTool;\r\n    cornerstoneTools.addTool(EraserTool);\r\n    cornerstoneTools.setToolActive(\"Eraser\", {mouseButtonMask: 1})\r\n}\r\n\r\nfunction reductionOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    element.style.width = '256px';\r\n    element.style.height = '256px';\r\n    cornerstone.resize(element);\r\n}\r\n\r\nfunction expansionOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    element.style.width = '512px';\r\n    element.style.height = '512px';\r\n    cornerstone.resize(element);\r\n\r\n}\r\n\r\nfunction invertOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    const viewport = cornerstone.getViewport(element);\r\n    viewport.invert = !viewport.invert;\r\n    cornerstone.setViewport(element, viewport);\r\n}\r\n\r\nfunction interpolationOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    const viewport = cornerstone.getViewport(element);\r\n    viewport.pixelReplication = !viewport.pixelReplication;\r\n    cornerstone.setViewport(element, viewport);\r\n}\r\n\r\nfunction hflipOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    const viewport = cornerstone.getViewport(element);\r\n    viewport.hflip = !viewport.hflip;\r\n    cornerstone.setViewport(element, viewport);\r\n}\r\n\r\nfunction vflipOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    const viewport = cornerstone.getViewport(element);\r\n    viewport.vflip = !viewport.vflip;\r\n    cornerstone.setViewport(element, viewport);\r\n}\r\n\r\nfunction rotateOn() {\r\n    const element = document.getElementById('dicomImage')\r\n    const viewport = cornerstone.getViewport(element);\r\n    viewport.rotation += 90;\r\n    cornerstone.setViewport(element, viewport);\r\n}\r\n\r\nfunction drawCircle() {\r\n    const EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool;\r\n    cornerstoneTools.addTool(EllipticalRoiTool)\r\n    cornerstoneTools.setToolActive('EllipticalRoi', {mouseButtonMask: 1})\r\n}\r\n\r\nfunction drawRectangle() {\r\n    const RectangleRoiTool = cornerstoneTools.RectangleRoiTool;\r\n    cornerstoneTools.addTool(RectangleRoiTool)\r\n    cornerstoneTools.setToolActive('RectangleRoi', {mouseButtonMask: 1})\r\n}\r\n\r\n","import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport MainUIElements from \"./main/MainUI\";\n\nclass App extends React.Component {\n  render() {\n    return <div>\n      <MainUIElements/>\n    </div>\n\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}